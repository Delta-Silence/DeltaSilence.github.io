<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Delta Silence â€¢ Service Status</title>

  <link rel="stylesheet" href="https://sightsofiron.com/style.css">
  <link rel="icon" href="/logo.png" type="image/x-icon">

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg: #0b0d10;
      --bg2:#0f1318;
      --card:#12151a;
      --muted:#9aa3ad;
      --border:#1e2228;
      --ok:#00c776;      
      --maint:#ffa726;   
      --down:#e53935;    
      --accent:#00bcd4;
      --radius:16px;
      --shadow: 0 18px 40px rgba(0,0,0,.55);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:
        radial-gradient(1200px 700px at 50% -250px, #16202a 0%, #0b0d10 55%),
        linear-gradient(180deg, #0b0d10 0%, #0a0e13 100%);
      color:#fff;
      font-family:"Montserrat", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      font-weight:800;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:36px 18px;
    }

    .shell{
      width:100%;
      max-width: 780px;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:22px;
      text-align:center;
    }

    .brand{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:10px;
    }
    .brand h1{
      margin:0;
      font-size: clamp(1.6rem, 3.2vw, 2.4rem);
      letter-spacing:.6px;
    }
    .brand p{
      margin:0;
      color:var(--muted);
      font-weight:700;
      font-size:.95rem;
      line-height:1.4;
    }

    .legend{
      display:flex; gap:12px; flex-wrap:wrap; justify-content:center;
      color:var(--muted); font-size:.85rem; font-weight:800; margin-top:6px;
    }
    .pill{display:inline-flex; align-items:center; gap:8px; padding:8px 10px; border:1px solid var(--border); border-radius:999px; background:#0f141a}
    .dot{width:10px; height:10px; border-radius:50%}
    .ok{background:var(--ok)} .maint{background:var(--maint)} .down{background:var(--down)}

    .stack{
      width:100%;
      display:flex;
      flex-direction:column;
      gap:14px;
      margin-top:6px;
    }

    .card{
      background: linear-gradient(180deg, #151a22 0%, #12151a 100%);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:18px 18px;
      text-align:left;
    }
    .row{
      display:flex; align-items:center; justify-content:space-between; gap:16px;
    }
    .name{font-size:1.25rem}
    .badge{
      display:inline-block; padding:8px 14px; border-radius:12px; font-size:.95rem;
      font-weight:800; white-space:nowrap;
    }
    .online{ background:var(--ok); color:#042317 }
    .maintenance{ background:var(--maint); color:#2e1e00 }
    .offline{ background:var(--down); color:#fff }
    .meta{ margin-top:8px; color:var(--muted); font-weight:700; font-size:.9rem }

    .updated{
      color:var(--muted);
      font-weight:700;
      font-size:.9rem;
      margin-top:6px;
    }

    .error{
      display:none;
      width:100%;
      border:1px solid #402222;
      background:#1a0f0f;
      color:#ff9b9b;
      border-radius:12px;
      padding:12px 14px;
      font-weight:800;
    }
    .retry{
      margin-top:10px;
      display:inline-block;
      padding:10px 14px;
      border-radius:12px;
      background:var(--bg2);
      border:1px solid var(--border);
      color:#cfd6de;
      cursor:pointer;
    }
    .retry:hover{ border-color:var(--accent); color:#fff }

    /* Footer */
    footer{
      margin-top: 10px;
      color:#7f8893;
      font-size:.85rem;
    }

    .skeleton{
      position:relative; overflow:hidden;
      background:#0f1318; border:1px solid var(--border);
      border-radius: var(--radius); height:74px;
    }
    .skeleton::after{
      content:""; position:absolute; inset:0;
      background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,.06) 50%, transparent 100%);
      animation: shimmer 1.2s infinite;
    }
    @keyframes shimmer{
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }
  </style>
</head>
<body>
  <main class="shell">
    <div class="brand">
      <h1>Delta Silence â€¢ Service Status</h1>
      <p>Live health for Sights of Iron â€¢ Tactical Frontlines â€¢ Six Chambers Roulette</p>
    </div>

    <div class="legend">
      <span class="pill"><i class="dot ok"></i> Online</span>
      <span class="pill"><i class="dot maint"></i> Maintenance</span>
      <span class="pill"><i class="dot down"></i> Offline</span>
    </div>

    <section id="cards" class="stack" aria-live="polite">
      <div class="skeleton"></div>
      <div class="skeleton"></div>
      <div class="skeleton"></div>
    </section>

    <div id="updated" class="updated"></div>

    <div id="error" class="error">
      Failed to load status.json. Check your GitHub Pages URL or JSON validity.
      <div><button class="retry" onclick="loadStatus()">Try again</button></div>
    </div>

    <footer>Â© 2025 Delta Silence</footer>
  </main>

  <script>
    const JSON_URL = "https://raw.githubusercontent.com/Delta-Silence/DeltaSilence.github.io/main/status.json";

    const ORDER = ["Sights of Iron","Tactical Frontlines","Six Chambers Roulette"];

    const elCards   = document.getElementById("cards");
    const elUpdated = document.getElementById("updated");
    const elError   = document.getElementById("error");

    function badgeClass(s){
      const x = (s||"").toLowerCase();
      if(x==="online") return "online";
      if(x==="maintenance") return "maintenance";
      return "offline";
    }
    function badgeText(s){
      const x = (s||"").toLowerCase();
      if(x==="online") return "ðŸŸ¢ ONLINE";
      if(x==="maintenance") return "ðŸŸ  MAINTENANCE";
      return "ðŸ”´ OFFLINE";
    }
    function fmt(ts){
      try{
        const d = new Date(ts);
        if(isNaN(d)) return "";
        return d.toLocaleString();
      } catch { return ""; }
    }

    async function loadStatus(){
      elError.style.display = "none";

      try{
        const res = await fetch(JSON_URL, { cache: "no-store" });
        if(!res.ok) throw new Error(res.status + " " + res.statusText);
        const data = await res.json();

        const services = data.services || {};
        const details  = data.details || {};
        const notes    = data.notes || "";
        const last     = data.last_updated ? fmt(data.last_updated) : "";

        elCards.innerHTML = "";
        ORDER.forEach(name=>{
          const status = services[name] || "Offline";
          const help   = details[name] || "";

          const card = document.createElement("article");
          card.className = "card";
          card.innerHTML = `
            <div class="row">
              <div class="name">${name}</div>
              <div class="badge ${badgeClass(status)}">${badgeText(status)}</div>
            </div>
            <div class="meta">${help || "&nbsp;"}</div>
          `;
          elCards.appendChild(card);
        });

        elUpdated.textContent = `Last updated: ${last || "n/a"}${notes ? " â€¢ " + notes : ""}`;
      }catch(err){
        console.error(err);
        elError.style.display = "block";
      }
    }

    loadStatus();
    setInterval(loadStatus, 30000);
  </script>
</body>
</html>
